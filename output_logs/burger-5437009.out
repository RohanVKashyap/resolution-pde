Job started on shire-1-6 at Fri Sep  5 03:19:14 PM EDT 2025
Job ID: 5437009
GPU information:
Fri Sep  5 15:19:14 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.51.03              Driver Version: 575.51.03      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce GTX 1080 Ti     On  |   00000000:04:00.0 Off |                  N/A |
| 23%   34C    P8              8W /  250W |       3MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA GeForce GTX 1080 Ti     On  |   00000000:05:00.0 Off |                  N/A |
| 23%   30C    P8              8W /  250W |       3MiB /  11264MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
CUDA devices:
CUDA_VISIBLE_DEVICES: 0,1
Using device: cuda
[2025-09-05 15:19:23,438][root][INFO] - model:
  _target_: models.ffno.FFNO1D
  in_channels: 1
  out_channels: 1
  factor: 4
  n_modes: 256
  width: 128
  n_layers: 4
  ff_weight_norm: true
  n_ff_layers: 3
  layer_norm: true
  dropout: 0.2
  mode: full
  activation: gelu
  use_grid: true
dataset:
  dataset_params:
    _target_: dataloaders.ks_naive_true_multires.ks_true_multires_markov_dataset
    saved_folder: /data/user_data/rvk/ks/
    viscosity: 0.1
    L: 64.0
    lmax: 8
    et: 5.0
    nte: 51
    nt: 51
    train_s: 2048
    reduced_batch: 1
    reduced_resolution_t: 1
    data_mres_size:
      256: 0
      512: 1024
    add_res:
    - 32
    - 64
    - 128
    add_res_samples:
      128: 0
      64: 0
      32: 0
    downsample_from_res: 256
    data_normalizer: true
    normalization_type: simple
    num_samples_max: -1
    eval_dataset_target: dataloaders.ks_naive_markov.ks_markov_dataset
    eval_filename: KS_train_2048.h5
    eval_saved_folder: /data/user_data/rvk/ks/res_512/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51
  resize_to_train: false
  evaluation_type: naive_downsample
  window_size: 15
  original_res: 512
  max_test_resolution: 512
  train_mres: true
  pde: ks
training:
  batch_size: 64
  epochs: 100
  learning_rate: 0.001
  use_normalizer: false
project_name: ${dataset.pde}_${hydra:runtime.choices.model}
checkpoint_dir: checkpoints

Project name: ks_ffno_1d/ffno_1d
Model name: models.ffno.FFNO1D
PDE Dataset: ks
This is True Multi-Resolution Training. Train Resolution is the highest data resolution in the multi-resolution data
---------------------
Creating true multi-resolution KS dataset from /data/user_data/rvk/ks/
Parameters: visc_0.1_L64.0_lmax8_et5.0_nte51_nt51
Using filename pattern: KS_train_2048.h5
Target samples per resolution (from files): {256: 0, 512: 1024}
Additional downsampled resolutions: [32, 64, 128]
Target samples per downsampled resolution: {128: 0, 64: 0, 32: 0}
Will downsample from resolution: 256
Loading KS multi-resolution data from /data/user_data/rvk/ks/
Parameters: visc_0.1_L64.0_lmax8_et5.0_nte51_nt51
Target samples per resolution (from files): {256: 0, 512: 1024}
Additional downsampled resolutions: [32, 64, 128]
Target samples per downsampled resolution: {128: 0, 64: 0, 32: 0}
Will downsample from resolution: 256
Loading resolution 512 from /data/user_data/rvk/ks/res_512/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
Available data keys in 'train': ['dt', 'dx', 'pde_51-512', 't', 'x']
  Original data shape for 512: (2048, 51, 512)
  After time reduction: (2048, 51, 512)
  Split 'train' data shape: (1638, 51, 512)
  Subsampled to 819 samples for train split
  Added 40950 sample pairs from resolution 512
Adding downsampled resolutions: [32, 64, 128]
Adding downsampled data from /data/user_data/rvk/ks/res_256/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
  No downsampled samples allocated for train split at resolution 32
  No downsampled samples allocated for train split at resolution 64
  No downsampled samples allocated for train split at resolution 128
Total samples loaded: 40950
Resolution distribution:
  512_file: 40950 samples
Sample x shapes: [(1, 512), (1, 512), (1, 512)]
Sample y shapes: [(1, 512), (1, 512), (1, 512)]
Loading KS multi-resolution data from /data/user_data/rvk/ks/
Parameters: visc_0.1_L64.0_lmax8_et5.0_nte51_nt51
Target samples per resolution (from files): {256: 0, 512: 1024}
Additional downsampled resolutions: [32, 64, 128]
Target samples per downsampled resolution: {128: 0, 64: 0, 32: 0}
Will downsample from resolution: 256
Loading resolution 512 from /data/user_data/rvk/ks/res_512/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
Available data keys in 'train': ['dt', 'dx', 'pde_51-512', 't', 'x']
  Original data shape for 512: (2048, 51, 512)
  After time reduction: (2048, 51, 512)
  Split 'val' data shape: (204, 51, 512)
  Using all 204 samples for val split
  Added 10200 sample pairs from resolution 512
Adding downsampled resolutions: [32, 64, 128]
Adding downsampled data from /data/user_data/rvk/ks/res_256/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
  No downsampled samples allocated for val split at resolution 32
  No downsampled samples allocated for val split at resolution 64
  No downsampled samples allocated for val split at resolution 128
Total samples loaded: 10200
Resolution distribution:
  512_file: 10200 samples
Sample x shapes: [(1, 512), (1, 512), (1, 512)]
Sample y shapes: [(1, 512), (1, 512), (1, 512)]
Loading KS multi-resolution data from /data/user_data/rvk/ks/
Parameters: visc_0.1_L64.0_lmax8_et5.0_nte51_nt51
Target samples per resolution (from files): {256: 0, 512: 1024}
Additional downsampled resolutions: [32, 64, 128]
Target samples per downsampled resolution: {128: 0, 64: 0, 32: 0}
Will downsample from resolution: 256
Loading resolution 512 from /data/user_data/rvk/ks/res_512/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
Available data keys in 'train': ['dt', 'dx', 'pde_51-512', 't', 'x']
  Original data shape for 512: (2048, 51, 512)
  After time reduction: (2048, 51, 512)
  Split 'test' data shape: (206, 51, 512)
  Using all 206 samples for test split
  Added 10300 sample pairs from resolution 512
Adding downsampled resolutions: [32, 64, 128]
Adding downsampled data from /data/user_data/rvk/ks/res_256/visc_0.1_L64.0_lmax8_et5.0_nte51_nt51/KS_train_2048.h5
  No downsampled samples allocated for test split at resolution 32
  No downsampled samples allocated for test split at resolution 64
  No downsampled samples allocated for test split at resolution 128
Total samples loaded: 10300
Resolution distribution:
  512_file: 10300 samples
Sample x shapes: [(1, 512), (1, 512), (1, 512)]
Sample y shapes: [(1, 512), (1, 512), (1, 512)]
---------Using simple global normalization---------------
Global statistics: X(mean=0.000000, std=2.759130), Y(mean=0.000000, std=2.815614)

Final dataset sizes:
Train dataset size: 40950
Validation dataset size: 10200
Test dataset size: 10300
<dataloaders.ks_naive_true_multires.ks_true_multires_markov_dataset.<locals>.SimpleNormalizedDataset object at 0x14e1dc364b90>
Created resolution groups:
  Resolution 512: 40950 samples
Created resolution groups:
  Resolution 512: 10200 samples
Created resolution groups:
  Resolution 512: 10300 samples
<class 'torch.Tensor'> -9.89530235528946e-10 9.313225746154785e-10 0.9725477695465088 0.9723305702209473
FFNO1D(
  (in_proj): WNLinear(in_features=1, out_features=128, bias=True)
  (fourier_layers): ModuleList(
    (0-3): 4 x FSpectralConv1d(
      (fourier_weight): ParameterList(  (0): Parameter containing: [torch.float32 of size 128x128x256x2 (cuda:0)])
      (backcast_ff): FeedForward(
        (layers): ModuleList(
          (0): Sequential(
            (0): Linear(in_features=128, out_features=512, bias=True)
            (1): Dropout(p=0.2, inplace=False)
            (2): GELU(approximate='none')
            (3): Identity()
          )
          (1): Sequential(
            (0): Linear(in_features=512, out_features=512, bias=True)
            (1): Dropout(p=0.2, inplace=False)
            (2): GELU(approximate='none')
            (3): Identity()
          )
          (2): Sequential(
            (0): Linear(in_features=512, out_features=128, bias=True)
            (1): Dropout(p=0.2, inplace=False)
            (2): Identity()
            (3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (out_proj): WNLinear(in_features=128, out_features=1, bias=True)
)
Total Model Parameters: 35.13M
Trainable Parameters: 35.13M
